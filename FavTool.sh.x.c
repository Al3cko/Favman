#if 0
	shc Version 4.0.3, Generic Shell Script Compiler
	GNU GPL Version 3 Md Jahidul Hamid <jahidulhamid@yahoo.com>

	shc -f /Users/nicoladigregorio/Downloads/favtool-main/FavTool.sh 
#endif

static  char data [] = 
#define      shll_z	10
#define      shll	((&data[1]))
	"\045\033\137\274\336\062\031\357\072\203\156\230\365"
#define      opts_z	1
#define      opts	((&data[13]))
	"\130"
#define      tst2_z	19
#define      tst2	((&data[16]))
	"\123\342\221\111\043\210\255\012\156\013\152\035\150\177\265\275"
	"\257\156\207\254\241\353"
#define      msg2_z	19
#define      msg2	((&data[38]))
	"\222\306\246\061\176\122\033\035\202\001\257\176\131\260\120\265"
	"\111\346\345\203\140\274\355\221\345"
#define      text_z	5360
#define      text	((&data[150]))
	"\231\302\076\174\271\040\204\265\304\270\273\030\112\311\312\342"
	"\172\024\010\374\334\122\322\251\040\100\335\304\247\155\100\360"
	"\000\014\110\042\212\064\306\011\042\052\304\236\324\236\206\133"
	"\013\172\260\161\351\050\073\327\305\143\116\176\257\303\067\140"
	"\107\176\144\161\133\316\103\042\355\004\220\111\356\126\310\247"
	"\241\026\007\325\300\312\040\275\270\161\035\366\255\043\204\354"
	"\000\157\211\023\053\316\336\353\244\137\225\053\156\107\331\232"
	"\142\070\217\223\125\312\337\054\317\146\163\047\076\063\203\135"
	"\265\076\232\325\154\163\271\014\366\005\014\012\365\016\152\167"
	"\246\021\055\204\370\030\245\101\020\156\160\230\240\214\016\330"
	"\333\234\313\232\007\223\250\311\120\367\145\110\377\173\046\302"
	"\126\103\327\050\243\154\305\167\027\174\237\330\115\053\035\164"
	"\234\347\241\326\362\204\107\002\120\252\315\146\216\336\101\070"
	"\067\073\245\052\306\252\056\204\203\237\154\026\351\166\114\033"
	"\341\120\073\203\245\016\110\235\355\107\353\170\231\356\055\051"
	"\071\115\013\037\175\035\356\325\271\110\234\112\365\114\177\031"
	"\026\000\134\255\325\257\216\020\074\256\132\320\033\345\353\176"
	"\057\067\336\356\045\227\115\242\106\131\020\027\000\264\330\124"
	"\307\355\146\123\262\113\337\050\034\151\363\274\076\223\331\122"
	"\104\110\335\312\115\371\025\065\256\106\174\366\000\374\134\030"
	"\046\023\215\107\044\270\136\027\360\163\362\124\364\135\371\310"
	"\010\123\333\043\352\253\201\147\102\367\134\322\201\252\033\311"
	"\100\341\136\020\330\210\242\223\262\147\364\137\337\024\243\035"
	"\312\156\027\363\024\206\236\202\370\226\236\136\155\061\106\155"
	"\375\104\065\245\201\110\173\215\242\035\135\211\152\236\136\013"
	"\055\213\017\013\352\125\062\020\036\016\267\150\002\300\077\244"
	"\014\156\207\010\354\344\331\262\224\355\050\356\013\027\056\176"
	"\342\210\224\263\116\073\007\042\261\301\122\306\277\121\144\354"
	"\273\005\236\143\150\142\106\017\220\217\237\042\003\322\006\322"
	"\241\234\341\077\047\342\163\323\300\005\322\256\260\302\072\175"
	"\201\145\172\375\302\310\273\322\320\317\372\321\133\310\241\350"
	"\173\337\057\347\243\042\142\316\216\356\151\301\023\141\000\132"
	"\265\160\174\346\022\364\210\272\034\254\227\120\150\243\054\320"
	"\031\016\230\136\316\352\312\207\314\350\021\216\267\276\131\342"
	"\007\135\032\367\277\253\221\111\247\300\030\156\145\054\231\363"
	"\170\215\161\004\224\000\055\125\374\007\231\063\303\266\257\022"
	"\143\111\121\046\053\355\076\007\040\157\246\243\132\044\252\360"
	"\314\163\131\036\214\310\067\362\373\166\340\100\251\356\247\241"
	"\035\140\041\332\311\116\200\262\036\353\336\212\003\073\341\233"
	"\357\100\142\237\361\050\134\222\110\171\123\041\051\253\261\052"
	"\064\242\211\340\233\233\214\315\372\332\330\155\372\006\161\214"
	"\041\211\060\152\376\302\207\121\130\103\153\227\371\241\015\370"
	"\261\144\020\011\365\015\061\256\046\054\315\200\370\355\156\377"
	"\176\201\336\331\065\040\114\302\260\273\240\005\030\321\363\323"
	"\036\162\020\263\312\307\112\354\032\244\312\331\135\121\162\057"
	"\023\056\171\313\252\110\125\247\144\245\066\245\173\373\016\246"
	"\205\324\047\223\147\270\050\074\234\325\077\231\361\165\135\155"
	"\311\204\054\006\210\275\002\063\217\133\017\025\104\042\311\330"
	"\123\103\077\046\243\235\125\374\311\363\333\152\215\125\021\221"
	"\115\203\001\100\014\211\222\112\074\157\166\257\167\152\224\126"
	"\234\152\146\266\376\024\045\146\021\102\200\032\047\105\152\150"
	"\214\173\263\234\033\367\264\330\005\241\364\350\212\130\034\035"
	"\055\044\017\335\230\132\170\351\101\245\073\231\146\314\334\336"
	"\173\371\174\037\245\062\223\272\312\134\336\154\366\301\255\122"
	"\223\067\036\245\003\020\074\162\011\254\121\211\100\110\206\152"
	"\161\004\303\115\252\221\201\140\366\136\207\257\267\164\215\160"
	"\271\326\061\270\350\124\054\252\124\201\135\134\130\225\055\150"
	"\017\126\235\036\137\217\247\250\245\057\114\246\203\000\067\000"
	"\215\255\176\261\014\313\302\265\346\216\356\023\206\362\043\371"
	"\145\044\330\177\332\016\013\322\227\057\125\307\166\253\174\314"
	"\330\171\260\031\231\061\223\242\113\327\302\117\374\045\046\204"
	"\352\051\041\127\071\140\035\137\353\211\077\317\271\221\060\057"
	"\026\031\204\101\336\042\332\030\075\000\100\351\200\315\310\325"
	"\245\377\237\034\002\150\233\220\044\042\127\257\166\001\034\167"
	"\344\024\265\301\346\165\031\262\214\221\206\202\165\056\204\311"
	"\102\132\314\372\315\161\157\321\366\064\075\160\124\233\026\142"
	"\166\043\110\170\141\117\212\050\002\367\006\135\022\002\341\150"
	"\165\346\337\302\234\225\335\241\242\116\203\067\272\050\354\146"
	"\267\326\247\005\255\362\216\037\276\067\303\303\174\126\064\024"
	"\053\041\123\211\301\352\265\172\152\255\355\363\116\146\171\114"
	"\143\014\220\054\276\270\351\023\074\305\161\214\072\210\264\353"
	"\052\345\172\301\352\326\204\027\171\211\025\322\254\320\075\315"
	"\144\177\133\127\316\116\132\172\136\240\253\240\321\260\040\257"
	"\214\310\312\273\226\063\322\255\111\244\234\014\005\242\273\003"
	"\347\201\336\174\006\300\306\026\254\136\055\302\044\161\322\224"
	"\020\010\002\172\223\011\052\141\317\176\217\002\124\041\210\110"
	"\211\153\201\003\014\137\024\147\073\235\113\306\111\302\120\170"
	"\332\352\105\077\033\052\216\334\045\013\330\004\312\243\132\073"
	"\303\170\166\105\153\276\331\341\376\241\225\245\351\373\052\347"
	"\202\225\345\161\327\172\160\024\114\016\125\263\331\071\066\271"
	"\327\050\330\345\047\014\277\323\346\153\222\111\076\351\141\214"
	"\367\103\245\114\332\001\214\064\350\206\077\062\161\016\123\200"
	"\043\226\201\060\365\233\110\077\261\337\260\032\316\323\320\202"
	"\133\142\307\161\006\172\010\235\124\207\235\366\040\217\041\331"
	"\075\062\067\120\175\207\217\212\276\220\133\223\255\363\042\365"
	"\367\011\012\150\126\043\363\246\107\022\237\152\357\322\357\215"
	"\066\257\156\063\277\021\214\144\307\364\075\062\257\223\120\223"
	"\030\001\354\233\004\114\277\326\074\004\134\223\205\301\234\170"
	"\035\370\252\070\072\071\053\244\072\230\001\244\020\357\161\067"
	"\355\022\105\006\254\206\025\275\224\240\326\325\100\111\361\310"
	"\237\032\261\312\101\055\222\166\303\121\326\165\331\054\250\037"
	"\343\126\350\216\325\123\002\305\203\055\321\136\335\107\003\057"
	"\216\127\250\034\122\103\126\175\063\063\216\347\350\137\346\007"
	"\175\115\157\217\256\236\304\355\252\354\301\336\363\213\024\015"
	"\231\064\007\176\062\374\136\136\370\371\242\371\211\272\023\332"
	"\270\253\230\017\256\214\074\221\263\015\110\072\260\232\335\166"
	"\101\364\273\252\142\001\210\163\046\176\141\171\040\316\241\114"
	"\211\057\046\067\337\371\032\076\043\062\360\147\135\365\250\171"
	"\240\314\365\347\371\144\034\270\134\014\070\003\213\007\212\346"
	"\335\236\356\165\103\051\314\343\077\357\124\077\271\170\011\326"
	"\312\272\046\222\312\131\220\050\314\021\113\044\205\115\265\117"
	"\172\031\366\212\236\210\264\064\013\013\136\051\276\064\377\010"
	"\157\235\001\062\077\217\151\263\120\120\006\121\052\107\363\073"
	"\154\115\317\164\277\333\130\146\326\244\170\127\255\252\244\104"
	"\174\306\365\007\275\053\302\325\134\276\262\052\354\114\275\072"
	"\305\122\330\004\377\371\360\171\236\331\011\172\300\344\064\142"
	"\166\131\176\373\364\174\166\176\230\143\100\307\166\170\236\315"
	"\061\375\344\161\034\157\223\113\164\336\371\112\376\173\214\203"
	"\201\133\240\252\127\227\213\331\006\130\242\246\121\176\356\100"
	"\173\021\017\046\241\265\026\222\027\326\125\370\065\007\244\141"
	"\310\114\124\206\110\140\212\273\010\055\220\247\114\063\361\171"
	"\156\207\327\042\131\023\255\171\362\124\023\357\175\131\026\242"
	"\174\136\233\352\262\363\215\240\113\161\377\115\334\243\070\303"
	"\275\125\206\263\260\043\012\003\055\254\107\216\107\046\167\264"
	"\064\364\046\256\311\134\075\346\301\120\015\307\343\373\217\375"
	"\365\244\056\353\072\103\204\240\017\367\101\207\301\012\122\112"
	"\233\043\041\045\341\055\244\227\115\213\234\355\076\323\154\023"
	"\224\076\162\357\063\157\341\321\227\313\354\210\000\301\340\041"
	"\312\143\120\132\020\006\273\372\332\232\053\136\061\253\350\210"
	"\131\247\123\204\166\100\105\376\075\315\021\150\132\026\037\307"
	"\247\012\056\314\060\017\255\317\327\305\121\062\160\043\215\072"
	"\325\301\046\363\361\336\156\021\052\133\262\300\325\245\272\343"
	"\324\347\257\215\224\244\264\332\022\102\344\260\024\306\364\130"
	"\147\356\323\274\323\236\333\335\141\106\137\001\246\077\032\145"
	"\173\034\367\176\152\230\171\233\213\150\374\003\150\313\333\322"
	"\264\154\233\155\216\126\363\306\201\004\270\124\102\075\361\305"
	"\371\174\150\317\141\204\035\366\063\165\274\177\327\171\057\051"
	"\011\007\033\172\050\253\260\257\164\376\232\367\304\263\170\201"
	"\150\126\043\045\217\262\317\321\303\001\211\106\000\073\377\023"
	"\073\053\057\207\050\353\103\312\071\043\043\255\266\021\373\352"
	"\373\067\106\344\344\125\210\115\171\204\037\347\056\121\360\273"
	"\323\227\070\247\223\013\352\033\136\143\234\160\373\216\226\173"
	"\367\370\037\145\034\143\315\247\211\234\027\036\101\070\102\177"
	"\100\360\156\247\274\014\263\362\133\216\121\152\066\026\003\322"
	"\373\155\101\210\006\305\353\044\172\245\244\004\271\227\355\213"
	"\047\121\264\021\215\302\035\310\045\377\243\361\155\356\004\274"
	"\056\211\103\223\101\034\366\064\053\336\156\315\072\334\071\303"
	"\076\316\067\201\151\024\365\103\124\221\027\207\342\223\127\060"
	"\360\103\101\051\306\227\330\034\214\226\251\347\005\071\176\107"
	"\262\240\111\254\207\201\332\302\375\314\123\156\016\075\265\057"
	"\060\072\172\007\052\217\243\144\205\040\065\111\374\137\216\176"
	"\034\101\041\011\236\032\266\066\206\177\174\355\030\301\366\042"
	"\067\075\030\041\300\261\304\224\214\115\026\022\124\131\361\157"
	"\126\361\205\367\130\271\204\111\205\211\075\052\267\033\072\324"
	"\213\111\040\140\035\113\104\151\272\064\130\337\315\006\101\047"
	"\141\053\257\053\042\372\045\127\011\012\360\225\164\152\031\336"
	"\334\146\240\125\151\106\246\066\260\047\134\100\316\010\347\101"
	"\246\233\076\357\312\372\151\036\243\334\236\317\264\357\005\003"
	"\237\016\241\161\351\261\053\031\271\267\255\203\011\012\304\121"
	"\340\055\371\225\261\336\353\060\025\155\363\373\315\103\310\214"
	"\130\104\272\120\075\164\357\152\244\160\131\211\100\223\106\331"
	"\203\362\175\171\143\371\340\137\260\112\005\277\237\314\035\022"
	"\103\206\246\204\335\325\144\357\220\345\156\022\072\174\046\173"
	"\026\024\155\212\045\144\106\331\277\020\054\036\271\204\132\334"
	"\143\002\114\055\046\277\240\155\137\160\045\304\165\350\275\040"
	"\260\315\270\031\006\276\233\322\005\041\307\152\276\227\045\161"
	"\272\365\274\334\154\045\170\326\031\245\116\373\220\333\357\075"
	"\360\340\116\255\360\347\203\006\367\173\203\330\356\334\301\127"
	"\000\311\157\236\226\125\304\277\322\330\260\105\065\134\262\062"
	"\263\022\122\363\373\175\200\173\323\352\226\174\330\075\113\172"
	"\224\003\275\122\050\075\162\116\077\301\374\260\076\134\056\346"
	"\154\331\330\133\224\317\120\065\337\165\344\150\334\200\143\134"
	"\056\016\333\056\033\344\051\104\350\251\020\336\140\164\276\264"
	"\012\312\054\314\167\267\174\136\136\265\122\266\003\311\152\113"
	"\055\314\046\356\154\134\300\164\250\312\007\032\265\210\353\054"
	"\075\270\011\343\375\042\340\035\210\140\156\364\271\017\027\154"
	"\045\356\271\004\114\210\313\206\111\074\272\211\304\166\260\374"
	"\263\333\250\011\214\235\155\124\344\004\224\347\201\225\077\341"
	"\234\331\034\014\242\260\051\266\362\374\013\346\062\061\174\362"
	"\354\063\117\356\206\215\217\057\317\340\157\246\056\200\001\161"
	"\017\015\350\372\104\223\356\337\051\064\144\101\002\026\135\365"
	"\055\015\275\155\252\374\271\344\114\115\265\252\024\204\173\141"
	"\161\223\260\116\172\360\171\204\055\261\375\173\251\176\272\307"
	"\023\363\352\103\162\325\042\144\123\253\261\267\020\115\035\017"
	"\252\003\075\016\207\001\225\114\175\204\127\257\251\322\172\013"
	"\015\025\020\251\126\015\055\023\013\112\122\011\066\226\357\336"
	"\230\363\075\166\130\174\204\350\104\124\104\004\010\104\073\157"
	"\255\120\254\070\163\053\115\020\377\106\313\346\132\131\355\142"
	"\234\155\120\051\123\057\145\266\234\354\045\265\302\352\352\337"
	"\051\336\261\361\206\146\065\266\262\021\172\301\123\035\206\233"
	"\253\056\101\157\216\243\266\020\015\037\145\265\166\154\202\325"
	"\040\363\075\056\156\360\311\370\047\331\276\262\354\106\176\316"
	"\073\112\027\035\376\165\373\334\025\165\260\014\223\000\117\112"
	"\220\361\034\073\206\367\321\004\244\134\374\100\100\147\253\247"
	"\042\375\046\234\234\070\034\105\312\226\306\310\312\074\150\371"
	"\256\345\370\162\101\061\065\371\333\076\071\267\246\366\050\041"
	"\013\242\030\133\170\366\225\243\232\310\364\124\367\004\042\166"
	"\034\257\341\126\011\043\375\225\213\251\023\063\067\336\053\145"
	"\230\333\056\201\126\310\215\131\377\244\244\141\116\226\032\155"
	"\223\251\364\013\246\026\012\147\070\244\063\143\317\017\354\001"
	"\200\354\125\237\270\104\060\021\174\231\375\263\372\167\242\302"
	"\230\343\131\050\014\177\244\073\005\367\262\261\320\216\113\360"
	"\171\241\347\162\371\042\335\207\012\356\066\247\246\101\030\322"
	"\274\061\323\113\072\226\035\244\023\274\334\354\066\165\273\050"
	"\265\312\316\231\371\061\226\234\144\304\352\267\106\203\326\264"
	"\234\113\346\057\135\357\107\011\357\072\065\342\366\236\366\221"
	"\100\163\077\167\031\017\343\214\053\264\216\056\132\273\265\123"
	"\103\237\324\032\342\212\330\133\317\244\047\335\212\216\263\344"
	"\272\263\205\157\064\245\000\052\352\267\032\103\035\277\346\101"
	"\071\315\002\244\304\242\012\272\376\042\365\115\205\260\105\047"
	"\034\117\150\276\205\013\322\107\056\273\356\213\241\253\346\360"
	"\316\356\302\251\075\176\052\001\000\061\144\306\260\200\011\240"
	"\320\060\255\106\250\365\017\076\340\157\145\363\122\305\017\054"
	"\165\005\254\251\333\244\311\247\305\347\345\064\335\235\341\236"
	"\033\053\276\230\201\336\057\334\113\353\150\377\166\252\353\076"
	"\040\065\065\163\051\135\172\210\317\142\210\143\241\140\120\230"
	"\276\202\263\050\141\326\334\214\041\141\161\317\246\247\075\301"
	"\077\102\041\205\031\325\252\112\202\263\037\351\032\334\143\305"
	"\032\251\370\342\352\273\030\124\307\012\160\316\046\134\142\342"
	"\054\020\156\131\200\070\113\015\044\323\224\165\273\326\034\145"
	"\114\230\103\344\374\002\000\026\250\003\312\266\256\134\024\366"
	"\005\035\111\132\143\235\156\225\237\202\007\021\075\166\317\316"
	"\007\260\316\213\204\066\355\371\204\343\044\330\077\030\240\371"
	"\326\264\030\311\374\107\211\122\340\026\064\267\255\027\022\022"
	"\240\204\221\022\253\243\034\322\211\103\175\337\157\277\275\250"
	"\271\106\035\025\077\154\231\354\237\352\257\352\075\246\160\352"
	"\170\260\024\072\213\006\247\164\240\073\156\313\337\066\155\161"
	"\166\237\160\315\021\010\335\046\241\063\064\120\210\372\231\262"
	"\055\007\223\303\275\271\203\134\025\353\336\046\323\333\242\033"
	"\125\227\152\010\260\177\041\045\012\275\130\176\243\344\363\100"
	"\377\230\265\342\140\303\113\137\077\256\141\040\207\100\134\346"
	"\335\066\262\003\221\355\317\305\362\035\360\023\112\150\062\370"
	"\103\147\173\170\125\332\031\055\120\165\013\000\050\067\171\047"
	"\201\171\315\230\050\071\161\253\117\305\255\160\242\352\033\305"
	"\112\327\224\347\115\072\250\035\323\360\215\267\157\203\243\344"
	"\253\316\170\277\361\304\137\341\361\232\067\202\311\025\354\113"
	"\013\163\254\256\274\364\023\217\010\272\007\116\334\330\020\231"
	"\356\273\220\320\014\311\120\120\166\311\066\012\344\173\300\034"
	"\114\120\161\337\222\235\105\305\046\210\142\073\233\146\266\102"
	"\000\210\071\362\250\215\156\160\275\202\066\066\241\231\274\153"
	"\151\162\254\310\302\062\223\027\151\011\272\346\267\337\224\077"
	"\357\172\351\156\012\205\072\064\063\146\317\203\300\027\354\061"
	"\262\126\207\032\043\156\002\013\022\263\147\040\245\231\371\154"
	"\356\001\327\336\001\046\275\305\323\147\161\311\011\341\121\320"
	"\004\277\057\264\220\023\156\331\207\337\067\067\342\313\304\122"
	"\123\111\277\374\246\111\160\173\323\235\256\172\147\055\316\276"
	"\353\337\352\236\270\133\262\245\167\376\264\117\107\371\371\333"
	"\021\152\033\333\320\005\237\077\361\222\035\161\006\110\377\101"
	"\241\346\051\034\256\041\365\041\122\336\050\365\143\370\144\002"
	"\235\314\146\345\066\157\107\320\357\170\055\263\302\133\116\034"
	"\160\102\252\315\245\142\100\351\320\363\176\231\071\323\145\052"
	"\275\223\317\001\332\142\365\317\176\366\371\133\315\272\231\141"
	"\045\043\004\024\342\116\156\360\064\331\053\243\163\125\134\052"
	"\020\133\077\122\177\004\254\324\337\047\160\304\071\243\017\135"
	"\167\377\222\317\322\211\332\063\021\037\366\157\106\063\044\156"
	"\275\062\311\336\156\346\337\213\035\065\306\011\070\065\022\052"
	"\175\345\107\074\007\240\274\345\125\075\310\142\247\033\114\261"
	"\225\241\163\345\223\215\250\314\171\376\360\210\022\223\040\203"
	"\125\047\305\227\173\174\011\161\241\014\176\071\307\266\342\274"
	"\341\135\362\263\335\034\123\320\046\006\265\361\212\221\156\377"
	"\154\252\175\246\253\062\050\014\033\276\065\120\012\164\163\007"
	"\315\361\310\106\324\376\353\030\100\315\371\204\370\353\231\267"
	"\127\312\160\234\124\350\077\206\006\121\365\007\115\116\155\347"
	"\343\135\023\172\042\236\032\075\111\341\201\232\344\041\130\143"
	"\225\000\306\141\113\057\231\103\025\222\241\214\272\223\077\105"
	"\253\212\365\242\163\157\054\317\125\105\011\144\261\100\355\257"
	"\014\340\302\052\000\372\044\141\071\151\140\242\127\270\141\117"
	"\260\165\323\222\272\207\256\126\313\066\350\376\022\073\152\011"
	"\045\164\074\276\120\123\277\221\252\330\001\366\255\332\072\252"
	"\164\343\300\360\354\316\344\364\261\370\152\255\235\142\075\220"
	"\120\213\320\365\044\173\107\065\335\366\377\043\334\046\312\025"
	"\137\141\173\364\142\330\340\242\236\270\360\350\050\136\233\126"
	"\100\222\304\024\037\375\326\355\277\344\113\037\147\172\330\145"
	"\050\314\220\020\116\213\126\007\035\337\106\054\060\365\174\363"
	"\067\136\275\211\303\012\344\361\313\262\054\307\125\003\054\374"
	"\151\252\253\303\310\310\273\074\213\360\347\026\124\053\116\225"
	"\351\207\037\377\361\037\014\132\210\132\117\264\031\000\347\302"
	"\265\043\242\344\307\142\166\211\350\072\247\235\135\267\211\017"
	"\135\222\272\027\210\227\076\277\174\277\035\236\111\052\200\015"
	"\047\067\042\316\124\123\057\200\147\311\167\174\123\106\144\075"
	"\065\112\373\233\033\133\145\151\140\305\026\200\270\275\041\144"
	"\127\306\006\114\202\247\002\052\153\274\132\356\166\026\045\150"
	"\170\355\173\151\161\037\163\274\220\227\271\007\265\110\004\037"
	"\141\261\123\304\103\107\046\225\142\255\007\271\254\365\370\206"
	"\307\266\041\044\367\300\320\171\072\030\337\224\266\031\077\162"
	"\176\364\104\253\067\016\200\012\241\043\173\045\000\035\006\054"
	"\062\262\036\060\345\242\263\075\251\265\141\237\123\141\154\077"
	"\067\232\262\106\357\175\000\322\261\010\031\125\276\117\230\024"
	"\063\231\345\151\011\060\157\112\364\002\324\121\022\006\313\036"
	"\011\256\345\165\224\106\302\346\024\016\242\006\107\167\113\361"
	"\154\335\312\130\345\324\105\177\025\253\071\215\100\274\047\000"
	"\270\355\061\172\160\035\371\130\066\262\354\257\133\001\253\161"
	"\300\166\053\222\215\341\304\236\155\045\016\016\026\176\327\101"
	"\326\355\314\175\303\134\375\004\231\002\032\031\376\064\360\037"
	"\342\076\211\236\233\064\006\234\202\146\213\045\026\223\074\114"
	"\344\067\231\174\166\212\202\047\105\377\034\277\331\053\006\013"
	"\224\334\347\024\114\163\260\371\001\205\067\337\060\011\033\212"
	"\351\055\115\376\066\156\305\273\170\351\374\341\242\375\044\147"
	"\245\004\355\160\365\152\072\161\366\135\242\335\320\303\222\011"
	"\163\363\247\335\145\312\143\141\312\366\335\344\337\202\232\136"
	"\064\147\266\266\276\173\334\300\131\271\267\266\060\020\124\374"
	"\353\037\151\373\155\305\173\320\366\226\037\311\053\021\057\101"
	"\054\010\064\037\226\155\007\223\145\000\076\027\020\003\245\333"
	"\041\103\021\076\366\163\132\010\112\346\127\034\147\164\201\115"
	"\021\246\343\120\012\366\060\322\356\333\077\360\335\227\230\110"
	"\142\010\074\042\121\020\142\001\265\214\010\026\222\015\276\363"
	"\235\217\315\152\031\147\132\020\032\304\322\324\263\172\315\277"
	"\375\012\345\020\162\076\160\030\337\340\001\023\346\170\054\013"
	"\343\224\344\257\254\264\345\132\357\302\077\374\231\121\145\014"
	"\113\371\361\207\023\016\102\025\061\372\034\136\322\113\064\252"
	"\130\110\301\251\034\214\303\351\066\234\015\030\167\127\025\056"
	"\152\316\362\343\131\361\335\203\013\355\142\363\330\130\036\217"
	"\005\226\210\021\257\107\232\344\241\210\040\156\053\362\227\140"
	"\214\356\067\326\235\360\060\065\373\023\007\072\241\125\323\052"
	"\375\036\322\331\357\013\332\071\153\202\012\120\253\153\345\114"
	"\351\225\131\030\251\260\132\051\177\007\217\105\363\330\263\331"
	"\020\135\324\170\020\151\342\325\036\303\256\215\126\077\254\020"
	"\203\031\121\220\366\003\201\156\354\253\072\143\144\175\026\001"
	"\221\246\354\310\057\127\105\334\056\070\026\024\152\025\320\300"
	"\242\002\306\232\074\101\276\152\205\001\317\322\025\110\202\016"
	"\151\017\270\013\134\257\341\065\373\056\260\347\163\341\101\134"
	"\357\016\315\174\125\373\304\346\304\271\374\164\377\224\336\213"
	"\027\112\313\001\210\160\020\017\023\270\126\002\223\014\033\354"
	"\121\146\047\042\120\345\033\043\042\125\024\373\206\237\222\134"
	"\126\231\331\242\321\205\127\210\217\354\130\155\224\000\365\246"
	"\335\155\066\273\327\230\076\052\175\004\364\067\205\264\341\161"
	"\036\363\300\265\216\053\014\074\151\241\035\316\344\255\164\160"
	"\313\144\147\236\050\336\153\207\164\152\073\054\017\216\255\162"
	"\035\346\232\314\250\156\232\073\231\302\235\315\314\074\361\214"
	"\320\010\224\200\132\346\141\072\166\307\051\142\277\027\056\010"
	"\204\170\356\356\115\113\251\202\034\041\127\113\033\241\326\325"
	"\340\062\344\052\141\341\001\057\301\002\172\143\335\062\176\167"
	"\321\206\325\146\263\004\365\363\337\105\236\071\136\176\334\052"
	"\365\153\273\306\311\275\073\361\243\340\160\063\374\271\206\165"
	"\335\254\030\070\370\354\237\121\057\006\111\153\042\274\153\154"
	"\252\257\007\251\347\104\060\173\165\054\333\223\157\377\350\261"
	"\004\250\177\045\236\051\352\047\001\363\217\342\374\022\052\220"
	"\101\320\003\227\332\042\054\376\320\374\302\340\272\306\111\364"
	"\224\022\161\146\213\065\033\124\074\370\257\234\150\274\277\052"
	"\173\005\332\251\123\264\001\270\146\073\362\007\032\226\015\263"
	"\263\031\100\212\010\326\150\201\100\070\173\156\150\164\054\057"
	"\056\134\215\123\056\145\165\042\176\246\306\326\376\277\005\250"
	"\261\335\260\035\007\127\110\264\035\224\353\112\245\315\005\202"
	"\310\327\207\335\010\310\201\260\101\262\305\032\014\364\170\355"
	"\014\001\244\344\327\172\335\323\215\103\101\042\302\371\350\151"
	"\315\325\241\010\160\034\037\167\026\363\033\062\155\204\132\250"
	"\204\203\220\144\164\200\217\307\202\055\210\266\206\006\157\334"
	"\221\001\202\241\171\206\223\021\306\003\300\233\162\267\140\252"
	"\170\326\300\117\311\131\102\275\354\325\371\140\054\217\047\274"
	"\165\101\037\001\274\227\125\241\264\156\261\003\147\262\157\260"
	"\067\061\070\121\361\136\353\210\271\114\237\340\017\273\145\137"
	"\226\036\253\131\254\266\010\221\120\010\174\315\065\064\372\214"
	"\312\266\106\237\156\054\233\257\353\243\071\163\114\221\002\244"
	"\013\115\224\311\377\070\036\226\227\025\111\234\033\156\246\346"
	"\261\030\176\371\252\001\371\227\004\253\134\173\137\143\237\010"
	"\177\233\044\113\326\274\156\070\344\021\025\024\231\124\122\374"
	"\152\340\051\367\360\014\131\262\256\273\047\117\105\315\041\322"
	"\232\275\077\321\224\141\270\346\360\064\143\277\147\330\104\170"
	"\236\013\211\301\024\214\046\064\364\163\324\071\216\374\077\244"
	"\250\017\127\046\210\303\125\137\346\014\325\002\101\301\272\130"
	"\101\225\104\353\274\125\132\332\114\002\025\076\353\124\210\311"
	"\204\304\165\354\361\343\322\346\152\233\057\210\277\036\213\177"
	"\170\013\123\273\040\251\023\213\003\122\252\036\030\226\132\265"
	"\106\310\215\107\122\032\066\266\375\124\077\106\033\245\341\000"
	"\104\373\245\347\136\302\321\235\072\365\106\110\241\115\130\273"
	"\310\057\272\010\240\336\010\331\104\321\364\013\250\335\055\320"
	"\132\110\011\030\053\253\336\333\207\012\256\014\344\106\012\373"
	"\364\246\000\272\034\004\056\047\012\067\227\351\222\230\175\166"
	"\171\265\225\161\021\372\212\050\273\123\175\316\243\251\316\050"
	"\110\067\275\002\331\263\066\072\207\271\064\303\247\046\263\303"
	"\047\047\243\000\142\225\157\370\004\005\224\063\224\043\027\064"
	"\230\110\073\004\060\031\131\342\124\170\174\226\143\143\253\022"
	"\073\055\263\312\274\376\206\222\131\352\123\362\072\371\346\136"
	"\113\062\255\266\103\043\100\011\334\325\200\271\123\317\313\371"
	"\245\223\104\155\313\133\077\012\317\217\344\374\356\101\041\217"
	"\111\035\327\362\123\257\112\200\355\255\211\260\315\017\231\050"
	"\346\056\363\324\304\372\354\344\335\033\201\034\246\163\065\153"
	"\051\302\151\101\343\333\270\027\014\026\015\034\213\146\341\333"
	"\326\027\325\026\313\263\303\177\124\014\053\147\035\037\006\324"
	"\347\374\177\212\323\351\260\012\344\026\170\236\303\036\076\263"
	"\237\246\376\000\236\141\004\275\175\005\072\025\346\214\045\126"
	"\332\151\310\236\311\146\014\174\127\215\312\116\112\235\161\242"
	"\355\016\131\212\170\153\170\133\203\124\032\353\212\344\013\134"
	"\335\374\073\352\043\234\163\060\106\252\302\167\064\271\376\152"
	"\232\330\133\051\104\177\307\261\325\334\046\241\102\002\102\302"
	"\075\132\244\331\152\227\245\251\232\104\110\013\072\044\375\114"
	"\353\035\174\336\066\273\305\047\272\213\210\244\210\255\372\337"
	"\250\260\153\255\011\015\134\275\275\311\366\134\011\202\236\333"
	"\367\117\111\322\216\017\155\007\232\324\304\365\342\242\025\247"
	"\365\126\332\262\242\144\265\257\125\346\373\143\015\021\156\104"
	"\306\214\203\145\056\065\073\222\325\265\006\153\261\331\214\077"
	"\165\173\374\106\274\306\241\010\206\371\253\153\127\266\007\277"
	"\326\324\077\102\057\036\223\062\347\174\333\162\363\206\161\240"
	"\323\355\223\006\153\275\073\012\266\127\051\263\072\337\223\066"
	"\324\025\057\347\227\020\242\037\330\170\313\230\230\264\162\045"
	"\014\122\236\313\164\273\065\002\134\351\312\150\102\144\020\302"
	"\033\002\234\040\276\276\260\256\354\105\315\046\317\323\171\265"
	"\234\062\067\105\303\271\333\076\330\170"
#define      chk2_z	19
#define      chk2	((&data[6264]))
	"\243\236\004\333\340\050\007\273\017\314\122\333\170\345\215\021"
	"\075\225\070\200\230\133\214"
#define      chk1_z	22
#define      chk1	((&data[6288]))
	"\366\346\033\061\253\113\225\311\061\133\126\011\010\022\331\370"
	"\316\336\267\334\150\307\027\326\141\305"
#define      pswd_z	256
#define      pswd	((&data[6362]))
	"\000\251\160\316\102\041\034\170\200\212\174\144\324\147\276\011"
	"\006\317\205\255\016\323\026\013\312\340\364\333\041\060\352\176"
	"\122\041\362\305\026\247\000\062\261\061\214\106\062\062\243\040"
	"\134\055\323\076\366\076\163\337\055\206\300\205\240\022\223\070"
	"\065\170\233\073\110\121\242\240\035\104\137\124\243\053\335\347"
	"\152\111\022\366\061\337\037\243\212\311\357\265\333\231\047\050"
	"\344\111\300\103\266\150\047\354\063\335\136\377\161\176\062\200"
	"\266\302\375\101\251\040\034\334\334\221\242\215\166\070\037\373"
	"\153\304\161\153\241\016\045\214\112\020\204\373\004\005\067\030"
	"\007\001\012\310\110\221\146\337\021\306\006\120\042\245\061\140"
	"\070\111\123\332\153\345\173\035\262\205\367\170\073\053\245\347"
	"\236\201\235\300\146\343\333\055\024\056\227\070\206\172\072\064"
	"\214\114\147\061\066\354\013\004\304\116\051\031\163\120\150\005"
	"\057\021\004\011\003\107\134\025\021\000\271\136\341\372\307\107"
	"\375\372\023\064\030\375\204\253\055\311\315\032\204\035\047\013"
	"\000\120\007\105\115\011\353\053\147\065\330\150\236\053\153\372"
	"\127\016\211\243\372\271\073\270\335\004\216\241\327\147\203\160"
	"\377\323\245\111\345\346\116\304\145\355\345\312\011\237\310\131"
	"\232\246\344\305\221\173\167\160\377\013\166\053\322\370\154\042"
	"\303\275\164\322\303\260\321\016\303\003\244\206\101\036\300"
#define      msg1_z	65
#define      msg1	((&data[6640]))
	"\221\121\236\247\160\032\274\147\004\324\122\013\237\147\367\140"
	"\351\132\257\257\254\066\306\230\217\265\304\127\232\261\067\122"
	"\002\014\043\225\042\162\227\043\073\164\222\354\011\370\317\061"
	"\355\140\025\033\131\035\132\342\372\324\210\057\215\332\170\352"
	"\143\051\333\320\306\146\217\066\023\110"
#define      inlo_z	3
#define      inlo	((&data[6705]))
	"\064\067\263"
#define      lsto_z	1
#define      lsto	((&data[6708]))
	"\123"
#define      xecc_z	15
#define      xecc	((&data[6712]))
	"\264\373\330\350\304\053\244\176\142\207\105\152\261\232\140\132"
	"\353\026"
#define      date_z	1
#define      date	((&data[6727]))
	"\221"
#define      tst1_z	22
#define      tst1	((&data[6733]))
	"\200\005\256\010\237\225\164\056\376\307\352\376\110\035\241\027"
	"\323\060\174\244\241\014\363\173\362\217\132\165"
#define      rlax_z	1
#define      rlax	((&data[6756]))
	"\335"/* End of data[] */;
#define      hide_z	4096
#define SETUID 0	/* Define as 1 to call setuid(0) at start of script */
#define DEBUGEXEC	0	/* Define as 1 to debug execvp calls */
#define TRACEABLE	1	/* Define as 1 to enable ptrace the executable */
#define HARDENING	0	/* Define as 1 to disable ptrace/dump the executable */
#define BUSYBOXON	0	/* Define as 1 to enable work with busybox */

#if HARDENING
static const char * shc_x[] = {
"/*",
" * Copyright 2019 - Intika <intika@librefox.org>",
" * Replace ******** with secret read from fd 21",
" * Also change arguments location of sub commands (sh script commands)",
" * gcc -Wall -fpic -shared -o shc_secret.so shc_secret.c -ldl",
" */",
"",
"#define _GNU_SOURCE /* needed to get RTLD_NEXT defined in dlfcn.h */",
"#define PLACEHOLDER \"********\"",
"#include <dlfcn.h>",
"#include <stdlib.h>",
"#include <string.h>",
"#include <unistd.h>",
"#include <stdio.h>",
"#include <signal.h>",
"",
"static char secret[128000]; //max size",
"typedef int (*pfi)(int, char **, char **);",
"static pfi real_main;",
"",
"// copy argv to new location",
"char **copyargs(int argc, char** argv){",
"    char **newargv = malloc((argc+1)*sizeof(*argv));",
"    char *from,*to;",
"    int i,len;",
"",
"    for(i = 0; i<argc; i++){",
"        from = argv[i];",
"        len = strlen(from)+1;",
"        to = malloc(len);",
"        memcpy(to,from,len);",
"        // zap old argv space",
"        memset(from,'\\0',len);",
"        newargv[i] = to;",
"        argv[i] = 0;",
"    }",
"    newargv[argc] = 0;",
"    return newargv;",
"}",
"",
"static int mymain(int argc, char** argv, char** env) {",
"    //fprintf(stderr, \"Inject main argc = %d\\n\", argc);",
"    return real_main(argc, copyargs(argc,argv), env);",
"}",
"",
"int __libc_start_main(int (*main) (int, char**, char**),",
"                      int argc,",
"                      char **argv,",
"                      void (*init) (void),",
"                      void (*fini)(void),",
"                      void (*rtld_fini)(void),",
"                      void (*stack_end)){",
"    static int (*real___libc_start_main)() = NULL;",
"    int n;",
"",
"    if (!real___libc_start_main) {",
"        real___libc_start_main = dlsym(RTLD_NEXT, \"__libc_start_main\");",
"        if (!real___libc_start_main) abort();",
"    }",
"",
"    n = read(21, secret, sizeof(secret));",
"    if (n > 0) {",
"      int i;",
"",
"    if (secret[n - 1] == '\\n') secret[--n] = '\\0';",
"    for (i = 1; i < argc; i++)",
"        if (strcmp(argv[i], PLACEHOLDER) == 0)",
"          argv[i] = secret;",
"    }",
"",
"    real_main = main;",
"",
"    return real___libc_start_main(mymain, argc, argv, init, fini, rtld_fini, stack_end);",
"}",
"",
0};
#endif /* HARDENING */

/* rtc.c */

#include <sys/stat.h>
#include <sys/types.h>

#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <unistd.h>

/* 'Alleged RC4' */

static unsigned char stte[256], indx, jndx, kndx;

/*
 * Reset arc4 stte. 
 */
void stte_0(void)
{
	indx = jndx = kndx = 0;
	do {
		stte[indx] = indx;
	} while (++indx);
}

/*
 * Set key. Can be used more than once. 
 */
void key(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		do {
			tmp = stte[indx];
			kndx += tmp;
			kndx += ptr[(int)indx % len];
			stte[indx] = stte[kndx];
			stte[kndx] = tmp;
		} while (++indx);
		ptr += 256;
		len -= 256;
	}
}

/*
 * Crypt data. 
 */
void arc4(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		indx++;
		tmp = stte[indx];
		jndx += tmp;
		stte[indx] = stte[jndx];
		stte[jndx] = tmp;
		tmp += stte[indx];
		*ptr ^= stte[tmp];
		ptr++;
		len--;
	}
}

/* End of ARC4 */

#if HARDENING

#include <sys/ptrace.h>
#include <sys/wait.h>
#include <signal.h>
#include <sys/prctl.h>
#define PR_SET_PTRACER 0x59616d61

/* Seccomp Sandboxing Init */
#include <stdlib.h>
#include <stdio.h>
#include <stddef.h>
#include <string.h>
#include <unistd.h>
#include <errno.h>

#include <sys/types.h>
#include <sys/prctl.h>
#include <sys/syscall.h>
#include <sys/socket.h>

#include <linux/filter.h>
#include <linux/seccomp.h>
#include <linux/audit.h>

#define ArchField offsetof(struct seccomp_data, arch)

#define Allow(syscall) \
    BPF_JUMP(BPF_JMP+BPF_JEQ+BPF_K, SYS_##syscall, 0, 1), \
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_ALLOW)

struct sock_filter filter[] = {
    /* validate arch */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, ArchField),
    BPF_JUMP( BPF_JMP+BPF_JEQ+BPF_K, AUDIT_ARCH_X86_64, 1, 0),
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),

    /* load syscall */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, offsetof(struct seccomp_data, nr)),

    /* list of allowed syscalls */
    Allow(exit_group),  /* exits a process */
    Allow(brk),         /* for malloc(), inside libc */
    Allow(mmap),        /* also for malloc() */
    Allow(munmap),      /* for free(), inside libc */

    /* and if we don't match above, die */
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),
};
struct sock_fprog filterprog = {
    .len = sizeof(filter)/sizeof(filter[0]),
    .filter = filter
};

/* Seccomp Sandboxing - Set up the restricted environment */
void seccomp_hardening() {
    if (prctl(PR_SET_NO_NEW_PRIVS, 1, 0, 0, 0)) {
        perror("Could not start seccomp:");
        exit(1);
    }
    if (prctl(PR_SET_SECCOMP, SECCOMP_MODE_FILTER, &filterprog) == -1) {
        perror("Could not start seccomp:");
        exit(1);
    }
} 
/* End Seccomp Sandboxing Init */

void shc_x_file() {
    FILE *fp;
    int line = 0;

    if ((fp = fopen("/tmp/shc_x.c", "w")) == NULL ) {exit(1); exit(1);}
    for (line = 0; shc_x[line]; line++)	fprintf(fp, "%s\n", shc_x[line]);
    fflush(fp);fclose(fp);
}

int make() {
	char * cc, * cflags, * ldflags;
    char cmd[4096];

	cc = getenv("CC");
	if (!cc) cc = "cc";

	sprintf(cmd, "%s %s -o %s %s", cc, "-Wall -fpic -shared", "/tmp/shc_x.so", "/tmp/shc_x.c -ldl");
	if (system(cmd)) {remove("/tmp/shc_x.c"); return -1;}
	remove("/tmp/shc_x.c"); return 0;
}

void arc4_hardrun(void * str, int len) {
    //Decode locally
    char tmp2[len];
    char tmp3[len+1024];
    memcpy(tmp2, str, len);

	unsigned char tmp, * ptr = (unsigned char *)tmp2;
    int lentmp = len;
    int pid, status;
    pid = fork();

    shc_x_file();
    if (make()) {exit(1);}

    setenv("LD_PRELOAD","/tmp/shc_x.so",1);

    if(pid==0) {

        //Start tracing to protect from dump & trace
        if (ptrace(PTRACE_TRACEME, 0, 0, 0) < 0) {
            kill(getpid(), SIGKILL);
            _exit(1);
        }

        //Decode Bash
        while (len > 0) {
            indx++;
            tmp = stte[indx];
            jndx += tmp;
            stte[indx] = stte[jndx];
            stte[jndx] = tmp;
            tmp += stte[indx];
            *ptr ^= stte[tmp];
            ptr++;
            len--;
        }

        //Do the magic
        sprintf(tmp3, "%s %s", "'********' 21<<<", tmp2);

        //Exec bash script //fork execl with 'sh -c'
        system(tmp2);

        //Empty script variable
        memcpy(tmp2, str, lentmp);

        //Clean temp
        remove("/tmp/shc_x.so");

        //Sinal to detach ptrace
        ptrace(PTRACE_DETACH, 0, 0, 0);
        exit(0);
    }
    else {wait(&status);}

    /* Seccomp Sandboxing - Start */
    seccomp_hardening();

    exit(0);
}
#endif /* HARDENING */

/*
 * Key with file invariants. 
 */
int key_with_file(char * file)
{
	struct stat statf[1];
	struct stat control[1];

	if (stat(file, statf) < 0)
		return -1;

	/* Turn on stable fields */
	memset(control, 0, sizeof(control));
	control->st_ino = statf->st_ino;
	control->st_dev = statf->st_dev;
	control->st_rdev = statf->st_rdev;
	control->st_uid = statf->st_uid;
	control->st_gid = statf->st_gid;
	control->st_size = statf->st_size;
	control->st_mtime = statf->st_mtime;
	control->st_ctime = statf->st_ctime;
	key(control, sizeof(control));
	return 0;
}

#if DEBUGEXEC
void debugexec(char * sh11, int argc, char ** argv)
{
	int i;
	fprintf(stderr, "shll=%s\n", sh11 ? sh11 : "<null>");
	fprintf(stderr, "argc=%d\n", argc);
	if (!argv) {
		fprintf(stderr, "argv=<null>\n");
	} else { 
		for (i = 0; i <= argc ; i++)
			fprintf(stderr, "argv[%d]=%.60s\n", i, argv[i] ? argv[i] : "<null>");
	}
}
#endif /* DEBUGEXEC */

void rmarg(char ** argv, char * arg)
{
	for (; argv && *argv && *argv != arg; argv++);
	for (; argv && *argv; argv++)
		*argv = argv[1];
}

void chkenv_end(void);

int chkenv(int argc)
{
	char buff[512];
	unsigned long mask, m;
	int l, a, c;
	char * string;
	extern char ** environ;

	mask = (unsigned long)getpid();
	stte_0();
	 key(&chkenv, (void*)&chkenv_end - (void*)&chkenv);
	 key(&data, sizeof(data));
	 key(&mask, sizeof(mask));
	arc4(&mask, sizeof(mask));
	sprintf(buff, "x%lx", mask);
	string = getenv(buff);
#if DEBUGEXEC
	fprintf(stderr, "getenv(%s)=%s\n", buff, string ? string : "<null>");
#endif
	l = strlen(buff);
	if (!string) {
		/* 1st */
		sprintf(&buff[l], "=%lu %d", mask, argc);
		putenv(strdup(buff));
		return 0;
	}
	c = sscanf(string, "%lu %d%c", &m, &a, buff);
	if (c == 2 && m == mask) {
		/* 3rd */
		rmarg(environ, &string[-l - 1]);
		return 1 + (argc - a);
	}
	return -1;
}

void chkenv_end(void){}

#if HARDENING

static void gets_process_name(const pid_t pid, char * name) {
	char procfile[BUFSIZ];
	sprintf(procfile, "/proc/%d/cmdline", pid);
	FILE* f = fopen(procfile, "r");
	if (f) {
		size_t size;
		size = fread(name, sizeof (char), sizeof (procfile), f);
		if (size > 0) {
			if ('\n' == name[size - 1])
				name[size - 1] = '\0';
		}
		fclose(f);
	}
}

void hardening() {
    prctl(PR_SET_DUMPABLE, 0);
    prctl(PR_SET_PTRACER, -1);

    int pid = getppid();
    char name[256] = {0};
    gets_process_name(pid, name);

    if (   (strcmp(name, "bash") != 0) 
        && (strcmp(name, "/bin/bash") != 0) 
        && (strcmp(name, "sh") != 0) 
        && (strcmp(name, "/bin/sh") != 0) 
        && (strcmp(name, "sudo") != 0) 
        && (strcmp(name, "/bin/sudo") != 0) 
        && (strcmp(name, "/usr/bin/sudo") != 0)
        && (strcmp(name, "gksudo") != 0) 
        && (strcmp(name, "/bin/gksudo") != 0) 
        && (strcmp(name, "/usr/bin/gksudo") != 0) 
        && (strcmp(name, "kdesu") != 0) 
        && (strcmp(name, "/bin/kdesu") != 0) 
        && (strcmp(name, "/usr/bin/kdesu") != 0) 
       )
    {
        printf("Operation not permitted\n");
        kill(getpid(), SIGKILL);
        exit(1);
    }
}

#endif /* HARDENING */

#if !TRACEABLE

#define _LINUX_SOURCE_COMPAT
#include <sys/ptrace.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <fcntl.h>
#include <signal.h>
#include <stdio.h>
#include <unistd.h>

#if !defined(PT_ATTACHEXC) /* New replacement for PT_ATTACH */
   #if !defined(PTRACE_ATTACH) && defined(PT_ATTACH)
       #define PT_ATTACHEXC	PT_ATTACH
   #elif defined(PTRACE_ATTACH)
       #define PT_ATTACHEXC PTRACE_ATTACH
   #endif
#endif

void untraceable(char * argv0)
{
	char proc[80];
	int pid, mine;

	switch(pid = fork()) {
	case  0:
		pid = getppid();
		/* For problematic SunOS ptrace */
#if defined(__FreeBSD__)
		sprintf(proc, "/proc/%d/mem", (int)pid);
#else
		sprintf(proc, "/proc/%d/as",  (int)pid);
#endif
		close(0);
		mine = !open(proc, O_RDWR|O_EXCL);
		if (!mine && errno != EBUSY)
			mine = !ptrace(PT_ATTACHEXC, pid, 0, 0);
		if (mine) {
			kill(pid, SIGCONT);
		} else {
			perror(argv0);
			kill(pid, SIGKILL);
		}
		_exit(mine);
	case -1:
		break;
	default:
		if (pid == waitpid(pid, 0, 0))
			return;
	}
	perror(argv0);
	_exit(1);
}
#endif /* !TRACEABLE */

char * xsh(int argc, char ** argv)
{
	char * scrpt;
	int ret, i, j;
	char ** varg;
	char * me = argv[0];
	if (me == NULL) { me = getenv("_"); }
	if (me == 0) { fprintf(stderr, "E: neither argv[0] nor $_ works."); exit(1); }

	ret = chkenv(argc);
	stte_0();
	 key(pswd, pswd_z);
	arc4(msg1, msg1_z);
	arc4(date, date_z);
	if (date[0] && (atoll(date)<time(NULL)))
		return msg1;
	arc4(shll, shll_z);
	arc4(inlo, inlo_z);
	arc4(xecc, xecc_z);
	arc4(lsto, lsto_z);
	arc4(tst1, tst1_z);
	 key(tst1, tst1_z);
	arc4(chk1, chk1_z);
	if ((chk1_z != tst1_z) || memcmp(tst1, chk1, tst1_z))
		return tst1;
	arc4(msg2, msg2_z);
	if (ret < 0)
		return msg2;
	varg = (char **)calloc(argc + 10, sizeof(char *));
	if (!varg)
		return 0;
	if (ret) {
		arc4(rlax, rlax_z);
		if (!rlax[0] && key_with_file(shll))
			return shll;
		arc4(opts, opts_z);
#if HARDENING
	    arc4_hardrun(text, text_z);
	    exit(0);
       /* Seccomp Sandboxing - Start */
       seccomp_hardening();
#endif
		arc4(text, text_z);
		arc4(tst2, tst2_z);
		 key(tst2, tst2_z);
		arc4(chk2, chk2_z);
		if ((chk2_z != tst2_z) || memcmp(tst2, chk2, tst2_z))
			return tst2;
		/* Prepend hide_z spaces to script text to hide it. */
		scrpt = malloc(hide_z + text_z);
		if (!scrpt)
			return 0;
		memset(scrpt, (int) ' ', hide_z);
		memcpy(&scrpt[hide_z], text, text_z);
	} else {			/* Reexecute */
		if (*xecc) {
			scrpt = malloc(512);
			if (!scrpt)
				return 0;
			sprintf(scrpt, xecc, me);
		} else {
			scrpt = me;
		}
	}
	j = 0;
#if BUSYBOXON
	varg[j++] = "busybox";
	varg[j++] = "sh";
#else
	varg[j++] = argv[0];		/* My own name at execution */
#endif
	if (ret && *opts)
		varg[j++] = opts;	/* Options on 1st line of code */
	if (*inlo)
		varg[j++] = inlo;	/* Option introducing inline code */
	varg[j++] = scrpt;		/* The script itself */
	if (*lsto)
		varg[j++] = lsto;	/* Option meaning last option */
	i = (ret > 1) ? ret : 0;	/* Args numbering correction */
	while (i < argc)
		varg[j++] = argv[i++];	/* Main run-time arguments */
	varg[j] = 0;			/* NULL terminated array */
#if DEBUGEXEC
	debugexec(shll, j, varg);
#endif
	execvp(shll, varg);
	return shll;
}

int main(int argc, char ** argv)
{
#if SETUID
   setuid(0);
#endif
#if DEBUGEXEC
	debugexec("main", argc, argv);
#endif
#if HARDENING
	hardening();
#endif
#if !TRACEABLE
	untraceable(argv[0]);
#endif
	argv[1] = xsh(argc, argv);
	fprintf(stderr, "%s%s%s: %s\n", argv[0],
		errno ? ": " : "",
		errno ? strerror(errno) : "",
		argv[1] ? argv[1] : "<null>"
	);
	return 1;
}
